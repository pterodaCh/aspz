# Практика 12-13
## Завдання. Варіант 2
Створіть демон, який відстежує процеси, що аварійно завершуються (через SIGFPE, SIGILL, SIGSEGV) та зберігає всю інформацію про контекст у базу даних SQLite.
##

Ця програма є демонстраційним прикладом демона, розробленим для ілюстрації процесу відстеження та логування аварійних процесів.

Розберімо детальніше. Демон - це фоновий процес, який запускається незалежно від будь-якого контролю користувача і виконує певні завдання для системи. Він створюється шляхом відокремлення процесу від батьківського і приєднання його до процесу init. Спочатку процес викликає fork() для створення дочірнього процесу. Потім дочірній процес викликає setid() для створення нового сеансу і від'єднання від будь-якого терміналу. Після цього він змінює свій робочий каталог на корінь (/), скидає права доступу до файлів і перенаправляє стандартний ввід, вивід і помилки до /dev/null. Врешті-решт, він запускається у фоновому режимі

Втім я вважаю важливо зазначити те, що програма не є повністю функціональним засобом спостереження. Замість того аби слідкувати за довільними системними процесами, створений демон сам створює власний дочірній процес, який навмисно викликає помилку сегментації (SIGSEGV). Таким чином створюєтсья чудовий ілюстративний та лаконічний приклад виконання завдання. Батьківський процес фіксує цей збій і записує інформацію про нього (pid, назва сигналу, час) в базу даних SQLite

Важливо прокумпілювати із флажком бази даних
```
gcc -Wall 2.c -o daemonlab -lsqlite3
```

Перевіряємо наявність процесу
```
ps aux | grep daemonlab
```

![image](https://github.com/user-attachments/assets/a26a9292-36d4-40c7-b990-de6f677dd300)

Програма працює у фоновому режимі та кожні 5 секунд створюючи процес, що аварійно завершується, а цей демон логує це. Для демостративного прикладу краще зачекати певний час, щоб у базі даних накопичилися записи. 

Дані можна передивитися у таблиці
```
sqlite3 crash_monitor.db "SELECT * FROM crashes;"
```
![image](https://github.com/user-attachments/assets/6f168971-597d-4aa5-9172-057726bfea11)

До речі, маскот BSD -  веселий на вигляд демон у кросівках і з вилами!
